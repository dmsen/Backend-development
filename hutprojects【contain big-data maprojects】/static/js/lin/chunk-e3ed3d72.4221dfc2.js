(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-e3ed3d72"],{"16e0":function(t,e,a){},"2d7d":function(t,e,a){t.exports=a("5037")},"3a8f":function(t,e,a){},"469f":function(t,e,a){a("6c1c"),a("1654"),t.exports=a("7d7b")},5037:function(t,e,a){a("c207"),a("1654"),a("6c1c"),a("837d"),a("5cb6"),a("fe1e"),a("7554"),t.exports=a("584a").Map},"520d":function(t,e,a){"use strict";a.r(e);var n=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",[a("Card",{staticClass:"headerCard",attrs:{"dis-hover":!0}},[a("Select",{attrs:{filterable:"",placeholder:"请选择机器","label-in-value":""},on:{"on-change":t.handleChooseMac},model:{value:t.equipmentId,callback:function(e){t.equipmentId=e},expression:"equipmentId"}},t._l(t.equipmentList,function(e){return a("Option",{key:e.id,attrs:{value:e.id}},[t._v(t._s(e.name))])}),1)],1),a("Card",{attrs:{"dis-hover":!0}},[a("Rate",{attrs:{value:1,count:1,character:"采用了 websocket 实时推送数据"}}),a("Rate",{attrs:{value:1,count:1,character:",在监测点配置页面配置机器监测点即可查看"}})],1),a("Card",{directives:[{name:"show",rawName:"v-show",value:t.equipmentId,expression:"equipmentId"}],staticStyle:{margin:"0 0px 20px 0px"},attrs:{"dis-hover":!0}},[a("Row",{staticStyle:{margin:"-20px 0 0 -20px"}},t._l(t.inforCardData,function(e,n){return a("i-col",{key:"infor-"+n,staticStyle:{height:"120px",padding:"10px"},attrs:{xs:12,md:8,lg:4}},[a("infor-card",{staticStyle:{margin:"12px"},attrs:{shadow:"",color:t.themeColor,icon:e.icon,"icon-size":36}},[a("count-to",{attrs:{end:e.count,"count-class":"count-style"}}),a("p",[t._v(t._s(e.title))])],1)],1)}),1)],1),a("Card",{attrs:{"dis-hover":!0}},[a("div",{attrs:{id:"lineChart"}})])],1)},r=[],i=a("f499"),o=a.n(i),s=a("7618"),u=a("a745"),c=a.n(u);function l(t){if(c()(t))return t}var d=a("5d73"),m=a.n(d);function f(t,e){var a=[],n=!0,r=!1,i=void 0;try{for(var o,s=m()(t);!(n=(o=s.next()).done);n=!0)if(a.push(o.value),e&&a.length===e)break}catch(u){r=!0,i=u}finally{try{n||null==s["return"]||s["return"]()}finally{if(r)throw i}}return a}function p(){throw new TypeError("Invalid attempt to destructure non-iterable instance")}function h(t,e){return l(t)||f(t,e)||p()}a("ac6a"),a("06db"),a("7f7f"),a("96cf");var g=a("3b8d"),v=a("2d7d"),y=a.n(v),w=a("e591"),b=a.n(w),V=a("d817"),x=a.n(V),S=a("3785"),C=a.n(S),A=a("9e04"),M=a("365c"),k=a("f564"),N=a("9349"),T=a("63a4"),F="dark"===localStorage.themeStyle?"#666":"blue"===localStorage.themeStyle?"#4884e2":"light"===localStorage.themeStyle?"#19be6b":"#ffa3d5";C()(b.a),x()(b.a),b.a.setOptions({global:{timezoneOffset:480,useUTC:!1},colors:[F]});var I=new y.a,L=0,q={components:{CountTo:N["a"],InforCard:T["a"]},data:function(){return{websock:null,themeColor:F,charts:null,dataArray:[],inforCardData:[],equipmentList:[],equipmentId:"",numC:!0,list:null,alarmInterval:null}},methods:{getMachines:function(){var t=Object(g["a"])(regeneratorRuntime.mark(function t(){var e,a,n;return regeneratorRuntime.wrap(function(t){while(1)switch(t.prev=t.next){case 0:return t.prev=0,t.next=3,Object(k["h"])();case 3:for(e=t.sent,a=0,n=e.data.msg.length;a<n;a++)this.equipmentList.push({id:e.data.msg[a].machineId,name:e.data.msg[a].machineName});t.next=10;break;case 7:t.prev=7,t.t0=t["catch"](0),void 0!==t.t0.response?Object(M["a"])(t.t0.response.status):Object(M["a"])(1);case 10:case"end":return t.stop()}},t,this,[[0,7]])}));function e(){return t.apply(this,arguments)}return e}(),handleChooseMac:function(){var t=this;if(this.dataArray=[],this.numC=!0,this.clearLine(),null!==this.charts)for(var e=0;e<t.charts.series.length;e++)t.charts.series[e].remove();console.log(t.equipmentId),this.websock.send(t.equipmentId)},clearLine:function(){this.charts&&this.charts.destroy(),this.charts=null,I=null,I=new y.a,this.inforCardData=[]},initWebpack:function(){this.websock=new WebSocket("ws://112.74.59.53/websocket")},webSocket:function(t){var e=this,a=this;this.websock.onopen=function(){e.websock.send(t)},this.websock.onmessage=function(t){console.log(t),t=JSON.parse(t.data),console.log(t);var n=(new Date).getTime();if(t.machineId===e.equipmentId){void 0!==I.get(t.physicalName)?I.get(t.physicalName).length>40?I.get(t.physicalName).shift():I.get(t.physicalName).push([t.time,t.value]):I.set(t.physicalName,[[t.time,t.value]]),!0===a.numC&&(0===a.dataArray.length||a.dataArray[0].name!==t.physicalName?a.dataArray.push({name:t.physicalName,data:[[t.time,t.value]]}):(a.numC=!1,a.charts=new b.a.Chart("lineChart",{plotOptions:{series:{cursor:"pointer",allowPointSelect:!0,animation:!0}},credits:{enabled:!1},xAxis:{type:"datetime",dateTimeLabelFormats:{millisecond:"%H:%M:%S.%L",second:"%H:%M:%S",minute:"%H:%M",hour:"%H:%M",day:"%m-%d",week:"%m-%d",month:"%Y-%m",year:"%Y"}},title:{text:"实时参数监控"},series:a.dataArray}))),setTimeout(function(){for(var e=0;e<a.dataArray.length;e++)if(t.physicalName===a.dataArray[e].name)try{a.dataArray[e].data.length<15?a.charts.series[e].addPoint([t.time,t.value]):a.charts.series[e].addPoint([t.time,t.value],!0,!0)}catch(n){}},2e3);var r=0;if(n-L>2e3){L=n;var i=!0,o=!1,u=void 0;try{for(var c,l=m()(I.entries());!(i=(c=l.next()).done);i=!0){var d=h(c.value,2),f=d[0],p=d[1];e.inforCardData.splice(r,1,{title:f,count:p[p.length-1][1]}),r++}}catch(g){o=!0,u=g}finally{try{i||null==l.return||l.return()}finally{if(o)throw u}}}r=0}else Object(s["a"])(t)!==Object&&t>0&&e.$Message.error({duration:1.5,content:"当前有异常数据！！！共"+t+"条 ,请查看异常记录"})},this.websock.onerror=function(){a.$Message.error({content:"监控子页获取信息失败",duration:3})},this.websock.onclose=function(){},this.$router.afterEach(function(){a.websock.close()})},initWebSocket:function(){var t="1:"+this.equipmentId;this.socketApi.initWebSocket(),this.socketApi.sendSock(t,this.getSocketVal)},getSocketVal:function(t){var e=this;t=o()(t),t=JSON.parse(t),console.log(t);var a=(new Date).getTime();if(t.machineId===this.equipmentId){void 0!==I.get(t.physicalName)?I.get(t.physicalName).length>40?I.get(t.physicalName).shift():I.get(t.physicalName).push([t.time,t.value]):I.set(t.physicalName,[[t.time,t.value]]),!0===e.numC&&(0===e.dataArray.length||e.dataArray[0].name!==t.physicalName?e.dataArray.push({name:t.physicalName,data:[[t.time,t.value]]}):(e.numC=!1,e.charts=new b.a.Chart("lineChart",{plotOptions:{series:{cursor:"pointer",allowPointSelect:!0,animation:!0}},credits:{enabled:!1},xAxis:{type:"datetime",dateTimeLabelFormats:{millisecond:"%H:%M:%S.%L",second:"%H:%M:%S",minute:"%H:%M",hour:"%H:%M",day:"%m-%d",week:"%m-%d",month:"%Y-%m",year:"%Y"}},title:{text:"实时参数监控"},series:e.dataArray})));for(var n=0;n<e.dataArray.length;n++)if(t.physicalName===e.dataArray[n].name)try{e.dataArray[n].data.length<15?e.charts.series[n].addPoint([t.time,t.value]):e.charts.series[n].addPoint([t.time,t.value],!0,!0)}catch(v){}var r=0;if(a-L>2e3){L=a;var i=!0,u=!1,c=void 0;try{for(var l,d=m()(I.entries());!(i=(l=d.next()).done);i=!0){var f=h(l.value,2),p=f[0],g=f[1];this.inforCardData.splice(r,1,{title:p,count:g[g.length-1][1]}),r++}}catch(y){u=!0,c=y}finally{try{i||null==d.return||d.return()}finally{if(u)throw c}}}r=0}else Object(s["a"])(t)!==Object&&t>0&&this.$Message.error({duration:1.5,content:"当前有异常数据！！！共"+t+"条 ,请查看异常记录"})},getMsgCall:function(){var t=Object(g["a"])(regeneratorRuntime.mark(function t(e){var a;return regeneratorRuntime.wrap(function(t){while(1)switch(t.prev=t.next){case 0:return t.prev=0,t.next=3,Object(A["j"])();case 3:a=t.sent,this.$Message.error({duration:1.5,content:"当前有异常数据！！！共"+a.data.msg+"条 ,请查看异常记录"}),t.next=9;break;case 7:t.prev=7,t.t0=t["catch"](0);case 9:case"end":return t.stop()}},t,this,[[0,7]])}));function e(e){return t.apply(this,arguments)}return e}()},beforeMount:function(){this.initWebpack(),this.getMachines(),this.$store.state.monitor.isGeneralChoose&&(this.equipmentId=this.$store.state.monitor.machId,this.webSocket(this.equipmentId))},destroyed:function(){this.websock.close()}},O=q,_=(a("ece9"),a("2877")),D=Object(_["a"])(O,n,r,!1,null,null,null);e["default"]=D.exports},"57f2":function(t,e,a){var n,r;!function(i,o){n=o,r="function"===typeof n?n.call(e,a,e,t):n,void 0===r||(t.exports=r)}(0,function(t,e,a){var n=function(t,e,a,n,r,i){for(var o=0,s=["webkit","moz","ms","o"],u=0;u<s.length&&!window.requestAnimationFrame;++u)window.requestAnimationFrame=window[s[u]+"RequestAnimationFrame"],window.cancelAnimationFrame=window[s[u]+"CancelAnimationFrame"]||window[s[u]+"CancelRequestAnimationFrame"];window.requestAnimationFrame||(window.requestAnimationFrame=function(t,e){var a=(new Date).getTime(),n=Math.max(0,16-(a-o)),r=window.setTimeout(function(){t(a+n)},n);return o=a+n,r}),window.cancelAnimationFrame||(window.cancelAnimationFrame=function(t){clearTimeout(t)});var c=this;for(var l in c.options={useEasing:!0,useGrouping:!0,separator:",",decimal:".",easingFn:null,formattingFn:null},i)i.hasOwnProperty(l)&&(c.options[l]=i[l]);""===c.options.separator&&(c.options.useGrouping=!1),c.options.prefix||(c.options.prefix=""),c.options.suffix||(c.options.suffix=""),c.d="string"==typeof t?document.getElementById(t):t,c.startVal=Number(e),c.endVal=Number(a),c.countDown=c.startVal>c.endVal,c.frameVal=c.startVal,c.decimals=Math.max(0,n||0),c.dec=Math.pow(10,c.decimals),c.duration=1e3*Number(r)||2e3,c.formatNumber=function(t){var e,a,n,r;if(t=t.toFixed(c.decimals),t+="",e=t.split("."),a=e[0],n=e.length>1?c.options.decimal+e[1]:"",r=/(\d+)(\d{3})/,c.options.useGrouping)for(;r.test(a);)a=a.replace(r,"$1"+c.options.separator+"$2");return c.options.prefix+a+n+c.options.suffix},c.easeOutExpo=function(t,e,a,n){return a*(1-Math.pow(2,-10*t/n))*1024/1023+e},c.easingFn=c.options.easingFn?c.options.easingFn:c.easeOutExpo,c.formattingFn=c.options.formattingFn?c.options.formattingFn:c.formatNumber,c.version=function(){return"1.7.1"},c.printValue=function(t){var e=c.formattingFn(t);"INPUT"===c.d.tagName?this.d.value=e:"text"===c.d.tagName||"tspan"===c.d.tagName?this.d.textContent=e:this.d.innerHTML=e},c.count=function(t){c.startTime||(c.startTime=t),c.timestamp=t;var e=t-c.startTime;c.remaining=c.duration-e,c.options.useEasing?c.countDown?c.frameVal=c.startVal-c.easingFn(e,0,c.startVal-c.endVal,c.duration):c.frameVal=c.easingFn(e,c.startVal,c.endVal-c.startVal,c.duration):c.countDown?c.frameVal=c.startVal-(c.startVal-c.endVal)*(e/c.duration):c.frameVal=c.startVal+(c.endVal-c.startVal)*(e/c.duration),c.countDown?c.frameVal=c.frameVal<c.endVal?c.endVal:c.frameVal:c.frameVal=c.frameVal>c.endVal?c.endVal:c.frameVal,c.frameVal=Math.round(c.frameVal*c.dec)/c.dec,c.printValue(c.frameVal),e<c.duration?c.rAF=requestAnimationFrame(c.count):c.callback&&c.callback()},c.start=function(t){return c.callback=t,c.rAF=requestAnimationFrame(c.count),!1},c.pauseResume=function(){c.paused?(c.paused=!1,delete c.startTime,c.duration=c.remaining,c.startVal=c.frameVal,requestAnimationFrame(c.count)):(c.paused=!0,cancelAnimationFrame(c.rAF))},c.reset=function(){c.paused=!1,delete c.startTime,c.startVal=e,cancelAnimationFrame(c.rAF),c.printValue(c.startVal)},c.update=function(t){cancelAnimationFrame(c.rAF),c.paused=!1,delete c.startTime,c.startVal=c.frameVal,c.endVal=Number(t),c.countDown=c.startVal>c.endVal,c.rAF=requestAnimationFrame(c.count)},c.printValue(c.startVal)};return n})},"58b5":function(t,e,a){},"5cb6":function(t,e,a){var n=a("63b6");n(n.P+n.R,"Map",{toJSON:a("f228")("Map")})},"5d6b":function(t,e,a){var n=a("e53d").parseInt,r=a("a1ce").trim,i=a("e692"),o=/^[-+]?0[xX]/;t.exports=8!==n(i+"08")||22!==n(i+"0x16")?function(t,e){var a=r(String(t),3);return n(a,e>>>0||(o.test(a)?16:10))}:n},"5d73":function(t,e,a){t.exports=a("469f")},"63a4":function(t,e,a){"use strict";var n=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("Card",{staticClass:"info-card-wrapper",attrs:{shadow:t.shadow,padding:0}},[a("div",{staticClass:"content-con"},[a("div",{staticClass:"left-area",style:{background:t.color,width:t.leftWidth}},[a("common-icon",{staticClass:"icon",attrs:{type:t.icon,size:t.iconSize,color:"#fff"}})],1),a("div",{staticClass:"right-area",style:{width:t.rightWidth}},[a("div",[t._t("default")],2)])])])},r=[],i=(a("c5f6"),a("cb21")),o={name:"InforCard",components:{CommonIcon:i["a"]},props:{left:{type:Number,default:6},color:{type:String,default:"#666"},icon:{type:String,default:""},iconSize:{type:Number,default:20},shadow:{type:Boolean,default:!1}},computed:{leftWidth:function(){return"".concat(this.left,"%")},rightWidth:function(){return"".concat(100-this.left,"%")}}},s=o,u=(a("a189"),a("2877")),c=Object(u["a"])(s,n,r,!1,null,null,null),l=c.exports;e["a"]=l},7445:function(t,e,a){var n=a("63b6"),r=a("5d6b");n(n.G+n.F*(parseInt!=r),{parseInt:r})},7554:function(t,e,a){a("68f7")("Map")},"7d7b":function(t,e,a){var n=a("e4ae"),r=a("7cd6");t.exports=a("584a").getIterator=function(t){var e=r(t);if("function"!=typeof e)throw TypeError(t+" is not iterable!");return n(e.call(t))}},"837d":function(t,e,a){"use strict";var n=a("5aee"),r=a("9f79"),i="Map";t.exports=a("ada4")(i,function(t){return function(){return t(this,arguments.length>0?arguments[0]:void 0)}},{get:function(t){var e=n.getEntry(r(this,i),t);return e&&e.v},set:function(t,e){return n.def(r(this,i),0===t?0:t,e)}},n,!0)},9349:function(t,e,a){"use strict";var n=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{staticClass:"count-to-wrapper"},[t._t("left"),a("p",{staticClass:"content-outer"},[a("span",{class:["count-to-count-text",t.countClass],attrs:{id:t.counterId}},[t._v(t._s(t.init))]),a("i",{class:["count-to-unit-text",t.unitClass]},[t._v(t._s(t.unitText))])]),t._t("right")],2)},r=[],i=a("e814"),o=a.n(i),s=(a("c5f6"),a("57f2")),u=a.n(s),c=(a("16e0"),{name:"CountTo",props:{init:{type:Number,default:0},startVal:{type:Number,default:0},end:{type:Number,required:!0},decimals:{type:Number,default:0},decimal:{type:String,default:"."},duration:{type:Number,default:2},delay:{type:Number,default:0},uneasing:{type:Boolean,default:!1},usegroup:{type:Boolean,default:!1},separator:{type:String,default:","},simplify:{type:Boolean,default:!1},unit:{type:Array,default:function(){return[[3,"K+"],[6,"M+"],[9,"B+"]]}},countClass:{type:String,default:""},unitClass:{type:String,default:""}},data:function(){return{counter:null,unitText:""}},computed:{counterId:function(){return"count_to_".concat(this._uid)}},methods:{getHandleVal:function(t,e){return{endVal:o()(t/Math.pow(10,this.unit[e-1][0])),unitText:this.unit[e-1][1]}},transformValue:function(t){var e=this.unit.length,a={endVal:0,unitText:""};if(t<Math.pow(10,this.unit[0][0]))a.endVal=t;else for(var n=1;n<e;n++)t>=Math.pow(10,this.unit[n-1][0])&&t<Math.pow(10,this.unit[n][0])&&(a=this.getHandleVal(t,n));return t>Math.pow(10,this.unit[e-1][0])&&(a=this.getHandleVal(t,e)),a},getValue:function(t){var e=0;if(this.simplify){var a=this.transformValue(t),n=a.endVal,r=a.unitText;this.unitText=r,e=n}else e=t;return e}},mounted:function(){var t=this;this.$nextTick(function(){var e=t.getValue(t.end);t.counter=new u.a(t.counterId,t.startVal,e,t.decimals,t.duration,{useEasing:!t.uneasing,useGrouping:t.useGroup,separator:t.separator,decimal:t.decimal}),setTimeout(function(){t.counter.error||t.counter.start()},t.delay)})},watch:{end:function(t){var e=this.getValue(t);this.counter.update(e)}}}),l=c,d=a("2877"),m=Object(d["a"])(l,n,r,!1,null,null,null),f=m.exports;e["a"]=f},a189:function(t,e,a){"use strict";var n=a("3a8f"),r=a.n(n);r.a},ac6a:function(t,e,a){for(var n=a("cadf"),r=a("0d58"),i=a("2aba"),o=a("7726"),s=a("32e9"),u=a("84f2"),c=a("2b4c"),l=c("iterator"),d=c("toStringTag"),m=u.Array,f={CSSRuleList:!0,CSSStyleDeclaration:!1,CSSValueList:!1,ClientRectList:!1,DOMRectList:!1,DOMStringList:!1,DOMTokenList:!0,DataTransferItemList:!1,FileList:!1,HTMLAllCollection:!1,HTMLCollection:!1,HTMLFormElement:!1,HTMLSelectElement:!1,MediaList:!0,MimeTypeArray:!1,NamedNodeMap:!1,NodeList:!0,PaintRequestList:!1,Plugin:!1,PluginArray:!1,SVGLengthList:!1,SVGNumberList:!1,SVGPathSegList:!1,SVGPointList:!1,SVGStringList:!1,SVGTransformList:!1,SourceBufferList:!1,StyleSheetList:!0,TextTrackCueList:!1,TextTrackList:!1,TouchList:!1},p=r(f),h=0;h<p.length;h++){var g,v=p[h],y=f[v],w=o[v],b=w&&w.prototype;if(b&&(b[l]||s(b,l,m),b[d]||s(b,d,v),u[v]=m,y))for(g in n)b[g]||i(b,g,n[g],!0)}},b9e9:function(t,e,a){a("7445"),t.exports=a("584a").parseInt},e814:function(t,e,a){t.exports=a("b9e9")},ece9:function(t,e,a){"use strict";var n=a("58b5"),r=a.n(n);r.a},fe1e:function(t,e,a){a("7075")("Map")}}]);